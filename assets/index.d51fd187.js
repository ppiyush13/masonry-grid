import{r as i,j as y,a as w,R,b as x,c as N,d as M,B as E}from"./vendor.d87d5cc6.js";const I=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))c(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const u of l.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&c(u)}).observe(document,{childList:!0,subtree:!0});function o(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerpolicy&&(l.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?l.credentials="include":r.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function c(r){if(r.ep)return;r.ep=!0;const l=o(r);fetch(r.href,l)}};I();const v=new URL("https://api.giphy.com/v1/gifs/trending");v.searchParams.set("api_key","OoWza0uVc3TYKVYzWNJ9cbZLR60T6oN8");const $=(e=50)=>{let t=0;return async()=>{v.searchParams.set("limit",e.toString()),v.searchParams.set("offset",(t*e+1).toString()),t+=1;const o=await fetch(v.toString()),{data:c}=await o.json();return c}},L=e=>{const t=i.exports.useRef(null),[o,c]=i.exports.useState([]);return i.exports.useEffect(()=>{if(t.current==null)return;const r=new IntersectionObserver(async l=>{if(l[0].isIntersecting){const u=await e();c(m=>m.concat(u))}},{rootMargin:"20%"});return r.observe(t.current),()=>{t.current&&r.unobserve(t.current)}},[t.current]),{data:o,loaderRef:t}};const s=y.exports.jsx,f=y.exports.jsxs,b=y.exports.Fragment,z=()=>{const e=["rgb(255, 243, 92)","rgb(255, 102, 102)","rgb(153, 51, 255)","rgb(0, 255, 153)","rgb(0, 204, 255)"],t=Math.floor(Math.random()*100)%e.length;return e[t]},k=e=>(16+ +e.height)/e.width,C=e=>{const t=document.createElement("div"),o=e.downsized_small,r=`
    <video
      src="${o.mp4}"
      autoplay
      muted
      loop
      width="100%"
      title={title}
      preload="none"
      crossorigin="anonymous"
      style="aspect-ratio: ${o.width} / ${o.height}; background-color: ${z()}"
    ></video>
  `;return t.innerHTML=r,t},_=({data:e})=>{const t=i.exports.useRef(),o=i.exports.useRef(),c=i.exports.useRef(),r=i.exports.useRef(),l=i.exports.useRef(0),u=i.exports.useRef([0,0,0,0]);return i.exports.useEffect(()=>{if(!e||e.length===0)return;const m=()=>{const a=u.current;let d=0,g=a[0];for(let p=1;p<a.length;p++)a[p]<g&&(g=a[p],d=p);return d},n=[t,o,c,r];console.time("start"),new Array(4).fill("");let h=new Array(4).fill(null).map(()=>document.createDocumentFragment());for(let a=l.current;a<e.length;a++){const d=e[a].images,g=m();h[g].appendChild(C(d).firstElementChild),u.current[g]+=k(d.downsized_small)}n.forEach((a,d)=>{a.current.appendChild(h[d])}),console.timeEnd("start"),l.current=e.length},[e]),f(b,{children:[f("div",{className:"grid-pane",children:[s("div",{className:"lane",ref:t}),s("div",{className:"lane",ref:o}),s("div",{className:"lane",ref:c}),s("div",{className:"lane",ref:r})]}),s("div",{style:{height:"1px"}})]})},j=({data:e})=>{const t=i.exports.useRef(0),o=i.exports.useRef([0,0,0,0]),[c,r]=i.exports.useState(()=>new Array(4).fill(null).map(()=>[]));return i.exports.useEffect(()=>{const l=n=>(16+ +n.height)/+n.width,u=()=>{const n=o.current;let h=0,a=n[0];for(let d=1;d<n.length;d++)n[d]<a&&(a=n[d],h=d);return h};console.time("start");const m=[...c];for(let n=t.current;n<e.length;n++){const h=e[n].images,a=u();m[a].push(s(A,{dataItem:h},n)),o.current[a]+=l(h.downsized_small)}r(m),t.current=e.length,console.timeEnd("start")},[e]),f("div",{className:"grid-pane",children:[s("div",{className:"lane",children:c[0]}),s("div",{className:"lane",children:c[1]}),s("div",{className:"lane",children:c[2]}),s("div",{className:"lane",children:c[3]})]})},A=({dataItem:e})=>s("video",{src:e.downsized_small.mp4,autoPlay:!0,muted:!0,loop:!0,width:"100%",preload:"none",crossOrigin:"anonymous",style:{aspectRatio:`${e.downsized_small.width} / ${e.downsized_small.height}`,backgroundColor:B()}}),B=()=>{const e=["rgb(255, 243, 92)","rgb(255, 102, 102)","rgb(153, 51, 255)","rgb(0, 255, 153)","rgb(0, 204, 255)"],t=Math.floor(Math.random()*100)%e.length;return e[t]},O=()=>{const e=["rgb(255, 243, 92)","rgb(255, 102, 102)","rgb(153, 51, 255)","rgb(0, 255, 153)","rgb(0, 204, 255)"],t=Math.floor(Math.random()*100)%e.length;return e[t]},S=e=>(16+ +e.height)/e.width,H=({data:e})=>{const t=i.exports.useRef(),o=i.exports.useRef(),c=i.exports.useRef(),r=i.exports.useRef(),l=i.exports.useRef(0),u=i.exports.useRef([0,0,0,0]);return i.exports.useEffect(()=>{if(!e||e.length===0||!t.current||!o.current||!c.current||!r.current)return;const m=()=>{const n=u.current;let h=0,a=n[0];for(let d=1;d<n.length;d++)n[d]<a&&(a=n[d],h=d);return h};t.current,o.current,c.current,r.current,P(l.current,[t.current,o.current,c.current,r.current],e,m,u.current),l.current=e.length},[e]),f(b,{children:[f("div",{className:"grid-pane",children:[s("div",{className:"lane",ref:t}),s("div",{className:"lane",ref:o}),s("div",{className:"lane",ref:c}),s("div",{className:"lane",ref:r})]}),s("div",{style:{height:"1px"}})]})},P=(e,t,o,c,r)=>{G(e,o.length,50,l=>{const u=o[l].images,m=c();t[m].appendChild(T(u).firstElementChild),r[m]+=S(u.downsized_small)})},T=e=>{const t=document.createElement("div"),o=e.downsized_small,r=`
    <video
      src="${o.mp4}"
      autoplay
      muted
      loop
      width="100%"
      title={title}
      preload="none"
      crossorigin="anonymous"
      style="aspect-ratio: ${o.width} / ${o.height}; background-color: ${O()}"
    ></video>
  `;return t.innerHTML=r,t},G=async(e,t,o,c)=>{const r=t-e,l=Math.ceil(r/o),u=Math.floor(r/l);for(let m=0;m<l;m++){console.time("start");for(let n=0,h=m*u;n<u&&h<r;n++,h++)requestIdleCallback(()=>c(e+h));console.timeEnd("start")}},D=({data:e})=>{const t=i.exports.useRef(0),o=i.exports.useRef([0,0,0,0]),[c,r]=i.exports.useState(()=>new Array(4).fill(null).map(()=>[]));return i.exports.useEffect(()=>{const l=n=>(16+ +n.height)/+n.width,u=()=>{const n=o.current;let h=0,a=n[0];for(let d=1;d<n.length;d++)n[d]<a&&(a=n[d],h=d);return h};console.time("start");const m=[...c];for(let n=t.current;n<e.length;n++){const h=e[n].images,a=u();m[a].push(s(F,{dataItem:h},n)),o.current[a]+=l(h.downsized_small)}r(m),t.current=e.length,console.timeEnd("start")},[e]),f("div",{className:"grid-pane",children:[s("div",{className:"lane",children:c[0]}),s("div",{className:"lane",children:c[1]}),s("div",{className:"lane",children:c[2]}),s("div",{className:"lane",children:c[3]})]})},F=({dataItem:e})=>s("video",{src:e.downsized_small.mp4,autoPlay:!0,muted:!0,loop:!0,width:"100%",preload:"none",crossOrigin:"anonymous",style:{aspectRatio:`${e.downsized_small.width} / ${e.downsized_small.height}`,backgroundColor:V()}}),V=()=>{const e=["rgb(255, 243, 92)","rgb(255, 102, 102)","rgb(153, 51, 255)","rgb(0, 255, 153)","rgb(0, 204, 255)"],t=Math.floor(Math.random()*100)%e.length;return e[t]},q=$();function K(){const{data:e,loaderRef:t}=L(q);return i.exports.useEffect(()=>{console.log("react version:",i.exports.version),console.log("react-dom version:",w.exports.version)},[]),f("main",{className:"App",children:[f(R,{children:[s(x,{path:"/react",element:s(j,{data:e})}),s(x,{path:"/javascript",element:s(_,{data:e})}),s(x,{path:"/javascript-idle",element:s(H,{data:e})}),s(x,{path:"react-lazy",element:s(D,{data:e})})]}),s("div",{ref:t,style:{height:"1px"}})]})}const U=N.createRoot(document.getElementById("root"));U.render(s(M.StrictMode,{children:s(E,{basename:"/masonry-grid/",children:s(K,{})})}));
