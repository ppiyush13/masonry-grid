import{r as i,j as b,a as R,R as N,b as x,c as M,d as E,B as I}from"./vendor.d87d5cc6.js";const L=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))c(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&c(d)}).observe(document,{childList:!0,subtree:!0});function o(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerpolicy&&(l.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?l.credentials="include":r.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function c(r){if(r.ep)return;r.ep=!0;const l=o(r);fetch(r.href,l)}};L();const v=new URL("https://api.giphy.com/v1/gifs/trending");v.searchParams.set("api_key","OoWza0uVc3TYKVYzWNJ9cbZLR60T6oN8");const $=(e=50)=>{let t=0;return async()=>{v.searchParams.set("limit",e.toString()),v.searchParams.set("offset",(t*e+1).toString()),t+=1;const o=await fetch(v.toString()),{data:c}=await o.json();return c}},z=e=>{const t=i.exports.useRef(null),[o,c]=i.exports.useState([]);return i.exports.useEffect(()=>{if(t.current==null)return;const r=new IntersectionObserver(async l=>{if(l[0].isIntersecting){const d=await e();c(f=>f.concat(d))}},{rootMargin:"20%"});return r.observe(t.current),()=>{t.current&&r.unobserve(t.current)}},[t.current]),{data:o,loaderRef:t}};const s=b.exports.jsx,m=b.exports.jsxs,w=b.exports.Fragment,k=()=>{const e=["rgb(255, 243, 92)","rgb(255, 102, 102)","rgb(153, 51, 255)","rgb(0, 255, 153)","rgb(0, 204, 255)"],t=Math.floor(Math.random()*100)%e.length;return e[t]},C=e=>(16+ +e.height)/e.width,_=e=>{const t=document.createElement("div"),o=e.downsized_small,r=`
    <video
      src="${o.mp4}"
      autoplay
      muted
      loop
      width="100%"
      title={title}
      preload="none"
      crossorigin="anonymous"
      style="aspect-ratio: ${o.width} / ${o.height}; background-color: ${k()}"
    ></video>
  `;return t.innerHTML=r,t},O=({data:e})=>{const t=i.exports.useRef(),o=i.exports.useRef(),c=i.exports.useRef(),r=i.exports.useRef(),l=i.exports.useRef(0),d=i.exports.useRef([0,0,0,0]);return i.exports.useEffect(()=>{if(!e||e.length===0)return;const f=()=>{const a=d.current;let u=0,g=a[0];for(let p=1;p<a.length;p++)a[p]<g&&(g=a[p],u=p);return u},n=[t,o,c,r];console.time("start"),new Array(4).fill("");let h=new Array(4).fill(null).map(()=>document.createDocumentFragment());for(let a=l.current;a<e.length;a++){const u=e[a].images,g=f();h[g].appendChild(_(u).firstElementChild),d.current[g]+=C(u.downsized_small)}n.forEach((a,u)=>{a.current.appendChild(h[u])}),console.timeEnd("start"),l.current=e.length},[e]),m(w,{children:[m("div",{className:"grid-pane",children:[s("div",{className:"lane",ref:t}),s("div",{className:"lane",ref:o}),s("div",{className:"lane",ref:c}),s("div",{className:"lane",ref:r})]}),s("div",{style:{height:"1px"}})]})},A=({data:e})=>{const t=i.exports.useRef(0),o=i.exports.useRef([0,0,0,0]),[c,r]=i.exports.useState(()=>new Array(4).fill(null).map(()=>[]));return i.exports.useEffect(()=>{const l=n=>(16+ +n.height)/+n.width,d=()=>{const n=o.current;let h=0,a=n[0];for(let u=1;u<n.length;u++)n[u]<a&&(a=n[u],h=u);return h};console.time("start");const f=[...c];for(let n=t.current;n<e.length;n++){const h=e[n].images,a=d();f[a].push(s(H,{dataItem:h},n)),o.current[a]+=l(h.downsized_small)}r(f),t.current=e.length,console.timeEnd("start")},[e]),m("div",{className:"grid-pane",children:[s("div",{className:"lane",children:c[0]}),s("div",{className:"lane",children:c[1]}),s("div",{className:"lane",children:c[2]}),s("div",{className:"lane",children:c[3]})]})},H=({dataItem:e})=>s("video",{src:e.downsized_small.mp4,autoPlay:!0,muted:!0,loop:!0,width:"100%",preload:"none",crossOrigin:"anonymous",style:{aspectRatio:`${e.downsized_small.width} / ${e.downsized_small.height}`,backgroundColor:T()}}),T=()=>{const e=["rgb(255, 243, 92)","rgb(255, 102, 102)","rgb(153, 51, 255)","rgb(0, 255, 153)","rgb(0, 204, 255)"],t=Math.floor(Math.random()*100)%e.length;return e[t]},j=()=>{const e=["rgb(255, 243, 92)","rgb(255, 102, 102)","rgb(153, 51, 255)","rgb(0, 255, 153)","rgb(0, 204, 255)"],t=Math.floor(Math.random()*100)%e.length;return e[t]},B=e=>(16+ +e.height)/e.width,S=({data:e})=>{const t=i.exports.useRef(),o=i.exports.useRef(),c=i.exports.useRef(),r=i.exports.useRef(),l=i.exports.useRef(0),d=i.exports.useRef([0,0,0,0]);return i.exports.useEffect(()=>{if(!e||e.length===0||!t.current||!o.current||!c.current||!r.current)return;const f=()=>{const n=d.current;let h=0,a=n[0];for(let u=1;u<n.length;u++)n[u]<a&&(a=n[u],h=u);return h};t.current,o.current,c.current,r.current,P(l.current,[t.current,o.current,c.current,r.current],e,f,d.current),l.current=e.length},[e]),m(w,{children:[m("div",{className:"grid-pane",children:[s("div",{className:"lane",ref:t}),s("div",{className:"lane",ref:o}),s("div",{className:"lane",ref:c}),s("div",{className:"lane",ref:r})]}),s("div",{style:{height:"1px"}})]})},P=(e,t,o,c,r)=>{D(e,o.length,50,l=>{const d=o[l].images,f=c();t[f].appendChild(G(d).firstElementChild),r[f]+=B(d.downsized_small)})},G=e=>{const t=document.createElement("div"),o=e.downsized_small,r=`
    <video
      src="${o.mp4}"
      autoplay
      muted
      loop
      width="100%"
      title={title}
      preload="none"
      crossorigin="anonymous"
      style="aspect-ratio: ${o.width} / ${o.height}; background-color: ${j()}"
    ></video>
  `;return t.innerHTML=r,t},D=async(e,t,o,c)=>{const r=t-e,l=Math.ceil(r/o),d=Math.floor(r/l);for(let f=0;f<l;f++){console.time("start");for(let n=0,h=f*d;n<d&&h<r;n++,h++)requestIdleCallback(()=>c(e+h));console.timeEnd("start")}},F=({data:e})=>{const t=i.exports.useRef(0),o=i.exports.useRef([0,0,0,0]),[c,r]=i.exports.useState(()=>new Array(4).fill(null).map(()=>[]));return i.exports.useEffect(()=>{const l=n=>(16+ +n.height)/+n.width,d=()=>{const n=o.current;let h=0,a=n[0];for(let u=1;u<n.length;u++)n[u]<a&&(a=n[u],h=u);return h};console.time("start");const f=[...c];for(let n=t.current;n<e.length;n++){const h=e[n].images,a=d();f[a].push(s(V,{dataItem:h},n)),o.current[a]+=l(h.downsized_small)}r(f),t.current=e.length,console.timeEnd("start")},[e]),m("div",{className:"grid-pane",children:[s("div",{className:"lane",children:c[0]}),s("div",{className:"lane",children:c[1]}),s("div",{className:"lane",children:c[2]}),s("div",{className:"lane",children:c[3]})]})},y=new IntersectionObserver(async e=>{e.forEach(t=>{t.isIntersecting?t.target.innerHTML=`
          <video
            src=${t.target.getAttribute("data-url")}
            autoPlay
            muted
            loop
            height="100%"
            width="100%"
            preload="none"
            crossOrigin="anonymous"
            style="height:100%;width:100%;"
          />
        `:t.target.innerHTML=""})}),V=({dataItem:e})=>{const t=i.exports.useRef(null);return i.exports.useEffect(()=>{if(t.current!=null)return y.observe(t.current),()=>{t.current&&y.unobserve(t.current)}},[]),s("div",{ref:t,"data-url":e.downsized_small.mp4,style:{display:"flex",width:"100%",aspectRatio:`${e.downsized_small.width} / ${e.downsized_small.height}`,backgroundColor:q()}})},q=()=>{const e=["rgb(255, 243, 92)","rgb(255, 102, 102)","rgb(153, 51, 255)","rgb(0, 255, 153)","rgb(0, 204, 255)"],t=Math.floor(Math.random()*100)%e.length;return e[t]},K=$();function U(){const{data:e,loaderRef:t}=z(K);return i.exports.useEffect(()=>{console.log("react version:",i.exports.version),console.log("react-dom version:",R.exports.version)},[]),m("main",{className:"App",children:[m(N,{children:[s(x,{path:"/react",element:s(A,{data:e})}),s(x,{path:"/javascript",element:s(O,{data:e})}),s(x,{path:"/javascript-idle",element:s(S,{data:e})}),s(x,{path:"react-lazy",element:s(F,{data:e})})]}),s("div",{ref:t,style:{height:"1px"}})]})}const W=M.createRoot(document.getElementById("root"));W.render(s(E.StrictMode,{children:s(I,{basename:"/masonry-grid/",children:s(U,{})})}));
