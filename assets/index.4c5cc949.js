import{r as i,j as y,a as R,R as N,b as x,c as M,d as E,B as $}from"./vendor.d87d5cc6.js";const L=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))c(r);new MutationObserver(r=>{for(const l of r)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&c(d)}).observe(document,{childList:!0,subtree:!0});function n(r){const l={};return r.integrity&&(l.integrity=r.integrity),r.referrerpolicy&&(l.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?l.credentials="include":r.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function c(r){if(r.ep)return;r.ep=!0;const l=n(r);fetch(r.href,l)}};L();const v=new URL("https://api.giphy.com/v1/gifs/trending");v.searchParams.set("api_key","OoWza0uVc3TYKVYzWNJ9cbZLR60T6oN8");const z=(e=50)=>{let t=0;return async()=>{v.searchParams.set("limit",e.toString()),v.searchParams.set("offset",(t*e+1).toString()),t+=1;const n=await fetch(v.toString()),{data:c}=await n.json();return c}},I=e=>{const t=i.exports.useRef(null),[n,c]=i.exports.useState([]);return i.exports.useEffect(()=>{if(t.current==null)return;const r=new IntersectionObserver(async l=>{if(l[0].isIntersecting){const d=await e();c(m=>m.concat(d))}},{rootMargin:"20%"});return r.observe(t.current),()=>{t.current&&r.unobserve(t.current)}},[t.current]),{data:n,loaderRef:t}};const o=y.exports.jsx,f=y.exports.jsxs,w=y.exports.Fragment,_=()=>{const e=["rgb(255, 243, 92)","rgb(255, 102, 102)","rgb(153, 51, 255)","rgb(0, 255, 153)","rgb(0, 204, 255)"],t=Math.floor(Math.random()*100)%e.length;return e[t]},k=e=>(16+ +e.height)/e.width,C=e=>{const t=document.createElement("div"),n=e.downsized_small,r=`
    <video
      src="${n.mp4}"
      autoplay
      muted
      loop
      width="100%"
      title={title}
      preload="none"
      crossorigin="anonymous"
      style="aspect-ratio: ${n.width} / ${n.height}; background-color: ${_()}"
    ></video>
  `;return t.innerHTML=r,t},O=({data:e})=>{const t=i.exports.useRef(),n=i.exports.useRef(),c=i.exports.useRef(),r=i.exports.useRef(),l=i.exports.useRef(0),d=i.exports.useRef([0,0,0,0]);return i.exports.useEffect(()=>{if(!e||e.length===0)return;const m=()=>{const a=d.current;let u=0,g=a[0];for(let p=1;p<a.length;p++)a[p]<g&&(g=a[p],u=p);return u},s=[t,n,c,r];console.time("start"),new Array(4).fill("");let h=new Array(4).fill(null).map(()=>document.createDocumentFragment());for(let a=l.current;a<e.length;a++){const u=e[a].images,g=m();h[g].appendChild(C(u).firstElementChild),d.current[g]+=k(u.downsized_small)}s.forEach((a,u)=>{a.current.appendChild(h[u])}),console.timeEnd("start"),l.current=e.length},[e]),f(w,{children:[f("div",{className:"grid-pane",children:[o("div",{className:"lane",ref:t}),o("div",{className:"lane",ref:n}),o("div",{className:"lane",ref:c}),o("div",{className:"lane",ref:r})]}),o("div",{style:{height:"1px"}})]})},H=({data:e})=>{const t=i.exports.useRef(0),n=i.exports.useRef([0,0,0,0]),[c,r]=i.exports.useState(()=>new Array(4).fill(null).map(()=>[]));return i.exports.useEffect(()=>{const l=s=>(16+ +s.height)/+s.width,d=()=>{const s=n.current;let h=0,a=s[0];for(let u=1;u<s.length;u++)s[u]<a&&(a=s[u],h=u);return h};console.time("start");const m=[...c];for(let s=t.current;s<e.length;s++){const h=e[s].images,a=d();m[a].push(o(T,{dataItem:h},s)),n.current[a]+=l(h.downsized_small)}r(m),t.current=e.length,console.timeEnd("start")},[e]),f("div",{className:"grid-pane",children:[o("div",{className:"lane",children:c[0]}),o("div",{className:"lane",children:c[1]}),o("div",{className:"lane",children:c[2]}),o("div",{className:"lane",children:c[3]})]})},T=({dataItem:e})=>o("video",{src:e.downsized_small.mp4,autoPlay:!0,muted:!0,loop:!0,width:"100%",preload:"none",crossOrigin:"anonymous",style:{aspectRatio:`${e.downsized_small.width} / ${e.downsized_small.height}`,backgroundColor:j()}}),j=()=>{const e=["rgb(255, 243, 92)","rgb(255, 102, 102)","rgb(153, 51, 255)","rgb(0, 255, 153)","rgb(0, 204, 255)"],t=Math.floor(Math.random()*100)%e.length;return e[t]},A=()=>{const e=["rgb(255, 243, 92)","rgb(255, 102, 102)","rgb(153, 51, 255)","rgb(0, 255, 153)","rgb(0, 204, 255)"],t=Math.floor(Math.random()*100)%e.length;return e[t]},B=e=>(16+ +e.height)/e.width,P=({data:e})=>{const t=i.exports.useRef(),n=i.exports.useRef(),c=i.exports.useRef(),r=i.exports.useRef(),l=i.exports.useRef(0),d=i.exports.useRef([0,0,0,0]);return i.exports.useEffect(()=>{if(!e||e.length===0||!t.current||!n.current||!c.current||!r.current)return;const m=()=>{const s=d.current;let h=0,a=s[0];for(let u=1;u<s.length;u++)s[u]<a&&(a=s[u],h=u);return h};t.current,n.current,c.current,r.current,S(l.current,[t.current,n.current,c.current,r.current],e,m,d.current),l.current=e.length},[e]),f(w,{children:[f("div",{className:"grid-pane",children:[o("div",{className:"lane",ref:t}),o("div",{className:"lane",ref:n}),o("div",{className:"lane",ref:c}),o("div",{className:"lane",ref:r})]}),o("div",{style:{height:"1px"}})]})},S=(e,t,n,c,r)=>{D(e,n.length,50,l=>{const d=n[l].images,m=c();t[m].appendChild(G(d).firstElementChild),r[m]+=B(d.downsized_small)})},G=e=>{const t=document.createElement("div"),n=e.downsized_small,r=`
    <video
      src="${n.mp4}"
      autoplay
      muted
      loop
      width="100%"
      title={title}
      preload="none"
      crossorigin="anonymous"
      style="aspect-ratio: ${n.width} / ${n.height}; background-color: ${A()}"
    ></video>
  `;return t.innerHTML=r,t},D=async(e,t,n,c)=>{const r=t-e,l=Math.ceil(r/n),d=Math.floor(r/l);for(let m=0;m<l;m++){console.time("start");for(let s=0,h=m*d;s<d&&h<r;s++,h++)requestIdleCallback(()=>c(e+h));console.timeEnd("start")}},F=({data:e})=>{const t=i.exports.useRef(0),n=i.exports.useRef([0,0,0,0]),[c,r]=i.exports.useState(()=>new Array(4).fill(null).map(()=>[]));return i.exports.useEffect(()=>{const l=s=>(16+ +s.height)/+s.width,d=()=>{const s=n.current;let h=0,a=s[0];for(let u=1;u<s.length;u++)s[u]<a&&(a=s[u],h=u);return h};console.time("start");const m=[...c];for(let s=t.current;s<e.length;s++){const h=e[s].images,a=d();m[a].push(o(V,{dataItem:h},s)),n.current[a]+=l(h.downsized_small)}r(m),t.current=e.length,console.timeEnd("start")},[e]),f("div",{className:"grid-pane",children:[o("div",{className:"lane",children:c[0]}),o("div",{className:"lane",children:c[1]}),o("div",{className:"lane",children:c[2]}),o("div",{className:"lane",children:c[3]})]})},V=({dataItem:e})=>{const t=i.exports.useRef(null);return i.exports.useEffect(()=>{if(t.current==null)return;const n=new IntersectionObserver(async c=>{t.current!=null&&(c[0].isIntersecting?t.current.innerHTML=`
          <video
            src=${e.downsized_small.mp4}
            autoPlay
            muted
            loop
            width="100%"
            preload="none"
            crossOrigin="anonymous"
          />
        `:t.current.innerHTML="")});return n.observe(t.current),e.downsized_small.mp4,`${e.downsized_small.width}${e.downsized_small.height}`,b(),()=>{t.current&&n.unobserve(t.current)}},[]),o("div",{ref:t,style:{width:"100%",aspectRatio:`${e.downsized_small.width} / ${e.downsized_small.height}`,backgroundColor:b()}})},b=()=>{const e=["rgb(255, 243, 92)","rgb(255, 102, 102)","rgb(153, 51, 255)","rgb(0, 255, 153)","rgb(0, 204, 255)"],t=Math.floor(Math.random()*100)%e.length;return e[t]},q=z();function K(){const{data:e,loaderRef:t}=I(q);return i.exports.useEffect(()=>{console.log("react version:",i.exports.version),console.log("react-dom version:",R.exports.version)},[]),f("main",{className:"App",children:[f(N,{children:[o(x,{path:"/react",element:o(H,{data:e})}),o(x,{path:"/javascript",element:o(O,{data:e})}),o(x,{path:"/javascript-idle",element:o(P,{data:e})}),o(x,{path:"react-lazy",element:o(F,{data:e})})]}),o("div",{ref:t,style:{height:"1px"}})]})}const U=M.createRoot(document.getElementById("root"));U.render(o(E.StrictMode,{children:o($,{basename:"/masonry-grid/",children:o(K,{})})}));
